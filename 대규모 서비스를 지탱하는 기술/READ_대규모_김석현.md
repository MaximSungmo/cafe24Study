# < 대규모 웹 서비스 >

## 1. 대규모 웹 서비스 개발 오리엔테이션

### 바이트 단위

비트(bit) < 바이트(B) < 킬로바이트 (KB) < 메가바이트 (MB) < 기가바이트 (GB) < 테라바이트 (TB) < 페타바이트 (PB) < 엑사바이트 (EB)

-	1024byte = 1KB (kilo byte)

-	1024KB = 1MB (mega byte)

-	1024MB = 1GB (giga byte) = 1048576 KB

-	1024GB = 1TB (tela byte)

-	1024TB = 1PB (peta byte)

### 초 단위

-	ms : 밀리초 0.001 = 10^(-3)초
-	㎲ : 마이크로초 0.000001초 = 10^(-6)초
-	㎱: 나노초 0.000000001초 = 10^(-9)초
-	㎰ : 피코초 0.000000000001초 = 10^(-12)초
-	fs : 펨토초 0.000000000000001초 = 10^(-15)초
-	as : 아토초 0.000000000000000001초 = 10^(-18)초

### scale-up

하드웨어의 성능을 높여 처리능력을 끌어 올리는 방법

### scale-out

서버를 횡으로 전개 즉 서버의 역할을 분담하거나 대수를 늘림으로써 시스템의 전체적인 처리능력을 높여서 부하를 분산시키는 방법

## 2. 대규모 데이터 처리 입문 ###대규모 데이터의 어려운 점
 메모리 내에서 계산할 수 없다. 메모리와 디스크는 CPU와 버스로 연결되어 있다. 메모리는 디스크보다 10^5 ~ 10^6 배 이상 빠르다. 최근 SSD(Solid State Drive) 는 물리적인 회전이 아니므로 Seek(탐색)은 빠르지만 버스 속도가 병목이 되거나 그 밖에 구조에 기인하는 면에 있어서 역시나 메모리만큼의 속도는 나오지 않는다.

**메모리** - 전기적인 부품이므로 물리적인 구조는 탐색속도와 관계없다. - 10^-6 초 단위 - 전송속도: 7.5GB/s

**디스크** - 헤드의 이동, 원반의 회전이라는 물리적인 이동이 필요하다. - 10^-3 초 단위 - 전송속도: 58MB/s

**CPU 캐쉬** - 10^-9 초 단위

### 병목 규명작업의 기본적인 흐름 - Load Average 확인`
시스템 전체의 부하 상황을 나타내는 지표
Load Average는 낮은데 시스템의 전송량이 오르지 않을 경우도 가끔 있다. 이럴 경우는 소프트웨어의 설정이나 오류, 네트워크, 원격 호스트 측에 원인이 없는지 등을 살펴본다.
` - CPU, I/O 중 병목 원인 조사

====================================================================
## 3. OS의 캐시구조 OS는 메모리를 이용하여 디스크 액세스를 줄인다. 원리를 알고 이를 전제로 애플리케이션을 작성하면 OS에 상당부분을 맡길 수 있다. => OS는 캐시 구조를 가지고 있다.

**Linux**

```
       - 페이지 캐시 (파일 캐시)

       - 버퍼 캐시
```

​

### OS 는 '가상 메모리구조'를 갖추고 있다.

##### => 가상 메모리 구조는 논리적인 <font color='red'>선형 어드레스</font>를 <font color='blue'>물리적인 어드레스</font>로 변환하는 것

​

OS라는 것은 메모리를 직접 프로세스로 넘기는 것이 아니라 일단 커널 내에서 메모리를 추상화하고 있다는 점이다.

​

메모리를 1바이트씩 액세스하는 것이 아니라 적당히 4KB 정도를 블록으로 확보해서 프로세스에 넘긴다. 여기서 1개의 블록을 '페이지' 라고 한다.

​

Linux 는 해당 파일의 i노드 번호, 해당 파일의 어느 위치부터 시작할지를 나타내는 오프셋 이 두가지 값을 키로 캐싱한다.

​

Linux 는 메모리가 비어있으면 전부 캐싱한다. 여기에는 제한이 없어서 Linux는 비어 있는 메모리 공간에 계속해서 디스크 내용을 캐싱해간다.

한편 프로세스에서 메모리를 요청했을 때 캐시로 인해 더 이상 메모리가 남아있지 않다면 오래된 캐시를 버리고 프로세스에 메모리를 확보해준다.

​

캐시를 전제로한 I/O 줄이는 방법

-	데이터 규모 < 물리 메모리 이면 전부 캐싱할 수 있다.

-	경제적 비용과의 밸런스 고려

-> 현재 일반적인 서버 메모리 : 8GB ~ 16GB

​

시스템을 구축하면 성능평가나 부하시험을 실시할 필요가 생길 것이다.

그때 초기값을 버려야 한다는 것을 기억해두길 바란다.

최초의 캐시가 최적화되어 있지 않은 단계에 '대략 5000요청/초'라고 해도 캐시가 올라가 있지 않았을 때와 캐시가 올라가 있을 때 낼 수 있는 속도는 완전히 다르다.

​

따라서 성능평가나0 부하시험도 캐시가 최적화된 후에 실시할 필요가 있다.

​

## Linux 에는 ext3, ext2, ext4, xfs 등 파일시스템

파일 시스템은 다양한 함수를 가지고 있는데 그 인터페이스를 통일하는 것이 VFS의 역할

=> 모두 같은 구조로 동일하게 캐싱이 이루어 진다는 장점

​

#### 커널 _ 컴퓨터의 운영 체제의 핵심이 되는 컴퓨터 프로그램의 하나로, 시스템의 모든 것을 완전히 통제한다

​

#### 페이지 = 가상 메모리의 최소 단위

​

#### LRU(Least Recently Used) - 가장 오래된 것을 파기하고 가장 새로운 것을 남겨놓는 형태
